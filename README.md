# ESM2 Protein Secondary Structure Prediction

This project predicts protein secondary structure using embeddings from **ESM2 (facebook/esm2_t12_35M_UR50D)** and a **BiLSTM classifier**.  
The workflow includes:
- Extracting per-residue embeddings from ESM2
- Training a BiLSTM classifier on labeled residues
- Generating predictions for test sequences

---

## Features
- ESM2 embedding extraction with caching
- Custom PyTorch dataset for residue-level labels
- BiLSTM classifier for 9-class secondary structure prediction
- Training loop with checkpointing
- Prediction script for test data

---

## Data Availability

The original dataset used in this project was provided as part of a university course and is **not publicly available**.

To make the repository runnable, a small synthetic dataset is generated:

- `example_sequences.fasta`
- `example_train.tsv`
- `example_test.tsv`

These files demonstrate the expected format and allow the code to run. They were generated by synthetic_data.py.

---

## Requirements

**Install with pip**

```bash
pip install -r requirements.txt
```
---

## How to run

1. Generate example data (optional):
   `python generate_synthetic_protein_data.py --out-dir ~/Downloads && cp ~/Downloads/synthetic_protein_data/* data/`

2. Create embeddings:
   `python src/embed.py --fasta data/sequences.fasta --out embeddings`

3. Train:
   `python src/train.py --train data/train.tsv --emb embeddings --checkpoint checkpoints/model_checkpoint.pt --epochs 4`

4. Predict:
   `python src/predict.py --test data/test.tsv --emb embeddings --checkpoint checkpoints/model_checkpoint.pt --out prediction.csv`



